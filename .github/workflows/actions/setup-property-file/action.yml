name: 'Setup Property File'
description: 'Generate treetracker.keys.properties file with either dummy or real keys from environment variables'

inputs:
  use_dummy_keys:
    description: 'Whether to use dummy keys instead of real secrets'
    required: false
    default: 'false'

runs:
  using: 'composite'
  steps:
    - name: Generate property file (dummy)
      if: inputs.use_dummy_keys == 'true'
      shell: bash
      run: |
        echo "#Treetracker API Keys" > treetracker.keys.properties
        echo "treetracker_client_id=dummy-id" >> treetracker.keys.properties
        echo "treetracker_client_secret=dummy-secret" >> treetracker.keys.properties
        echo "s3_dev_identity_pool_id=dummy-pool-id-dev" >> treetracker.keys.properties
        echo "s3_test_identity_pool_id=dummy-pool-id-test" >> treetracker.keys.properties
        echo "prod_treetracker_client_id=dummy-prod-id" >> treetracker.keys.properties
        echo "prod_treetracker_client_secret=dummy-prod-secret" >> treetracker.keys.properties
        echo "s3_production_identity_pool_id=dummy-pool-id-prod" >> treetracker.keys.properties

    - name: Generate property file (real)
      if: inputs.use_dummy_keys != 'true'
      shell: bash
      run: |
        echo "#Treetracker API Keys" > treetracker.keys.properties
        echo "s3_dev_identity_pool_id=${S3_DEV_IDENTITY_POOL_ID}" >> treetracker.keys.properties
        echo "s3_test_identity_pool_id=${S3_TEST_IDENTITY_POOL_ID}" >> treetracker.keys.properties
        echo "s3_production_identity_pool_id=${S3_PRODUCTION_IDENTITY_POOL_ID}" >> treetracker.keys.properties
        echo "treetracker_client_id=${TREETRACKER_CLIENT_ID}" >> treetracker.keys.properties
        echo "treetracker_client_secret=${TREETRACKER_CLIENT_SECRET}" >> treetracker.keys.properties
        echo "prod_treetracker_client_id=${PROD_TREETRACKER_CLIENT_ID}" >> treetracker.keys.properties
        echo "prod_treetracker_client_secret=${PROD_TREETRACKER_CLIENT_SECRET}" >> treetracker.keys.properties
